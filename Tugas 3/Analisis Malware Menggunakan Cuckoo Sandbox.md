#A. Pendahuluan
   Pengertian Malware adalah setiap program atau file yang berbahaya ("malicious software”)  bagi pengguna komputer. Dengan demikian, malware termasuk virus komputer,  worm, Trojan horse , dan juga spyware.

   Malware adalah aplikasi komputer yang khusus dibuat dengan tujuan mencari celah dan kelemahan software. Malware adalah malicious software atau perangkat lunak berbahaya, terdiri dari pemrograman (kode,script, konten aktif, dan perangkat lunak lain) yang dirancang untuk mengganggu atau menolak software dengan tujuan  mengumpulkan informasi yang mengarah pada hilangnya privasi atau eksploitasi, atau mendapatkan akses tidak sah ke sumber daya sistem, Baca Penjelasan di bawah ini

   Virus, Spyware, Worm, Trojan dan Malware adalah istilah yang seringkali kita dengar. Pada awal komputer dan Internet mulai merambah dunia, kita hanya tahu akan keberadaan Virus. Bahkan hingga sekarang  ini, jika komputer  tiba-tiba menemukan masalah misalnya menjadi lambat atau tidak beroperasi sesuai dengan harapan. Tidak apa-apalah anda memaki demikian karena memang mungkin karena ulah si virus yang memang membuat sial sedang menggerogoti komputer kesayangan anda. Namun selain dari virus adalagi masalah baru sejenis dengan munculnya spyware, worm, trojan dan malware.
   
   Pada percobaan kali ini akan dilakukan analisis sebuah file malware dengan format office word (.doc) pada cuckoo sandbox. Uji coba akan dilakukan pada sistem operasi Linux Ubuntu 16.04 LTS dengan guest OS windowsXP SP3 sebagai analyzer machine.


#B. Dasar teori

Sesuai dengan penjelasan diatas, pengujian akan dilakukan pada sistem operasi linux ubuntu 16.04 LTS yang telah terinstall cuckoo sandbox beserta virtualbox yang akan digunakan untuk menginstall guest berupa windowsXP SP3 sebagai analyzer machine. Malware yang digunakan didapat dari malwr.com. Berikut penjelasan masing - masing tool yang akan digunakan pada uji coba kali ini :

1. VMware Workstation

	VMWare Workstation adalah software untuk virtual machine yang compatible dengan komputer Intel x86. Software ini memungkinkan pemakai untuk membuat satu atau lebih virtual machine dan menjalankannya secara serempak. Masing-masing virtual machine dapat menjalankan guest operating system-nya sendiri seperti Linux, Windows, BSD, dan lain-lain. Tetapi software ini tidak dapat menjalankan virtual machine yang dibuat oleh produk VMWare yang lain.

2. Linux Ubuntu 16.04 LTS

	Ubuntu adalah [sistem operasi] lengkap berbasis Linux, tersedia secara bebas dan mempunyai dukungan baik yang berasal dari komunitas maupun tenaga ahli profesional. Komunitas Ubuntu dibentuk berdasarkan gagasan yang terdapat di dalam filosofi Ubuntu:
    * bahwa perangkat lunak harus tersedia dengan bebas biaya
    * bahwa aplikasi perangkat lunak tersebut harus dapat digunakan dalam bahasa lokal masing-masing dan untuk orang-orang yang mempunyai keterbatasan fisik, dan
    * bahwa pengguna harus mempunyai kebebasan untuk mengubah perangkat lunak sesuai dengan apa yang mereka butuhkan.
	Perihal kebebasan inilah yang membuat Ubuntu berbeda dari perangkat lunak berpemilik (proprietary); bukan hanya peralatan yang Anda butuhkan tersedia secara bebas biaya, tetapi Anda juga mempunyai hak untuk memodifikasi perangkat lunak Anda sampai perangkat lunak tersebut bekerja sesuai dengan yang Anda inginkan.

	Nama Ubuntu diambil dari nama sebuah konsep ideologi di Afrika Selatan. “Ubuntu” berasal dari bahasa kuno Afrika, yang berarti “rasa perikemanusian terhadap sesama manusia”. Ubuntu juga bisa berarti “aku adalah aku karena keberadaan kita semua”. Tujuan dari distribusi Linux Ubuntu adalah membawa semangat yang terkandung di dalam Ubuntu ke dalam dunia perangkat lunak.

3. Oracle VM VirtualBox

	Virtualbox adalah software gratis milik Oracle yang fungsi utamanya adalah mem-visualisasi-kan sebuah atau banyak Sistem Operasi (OS) di dalam Sistem Operasi utama kita. Misalnya anda memiliki sistem operasi windows namun ingin melakukan penelitian pada linux. Untuk menginstalasi dual boot perlu usaha sedikit extra, sedangkan dengan menggunakan VirtualBox, linux anda akan berjalan di dalam windows sehingga anda dapat sekaligus menggunakan windows.

	VirtualBox ini akan diinstal di dalam ubuntu dan akan digunakan untuk menginstall windowsXP SP sebagai analyzer machine untuk analisa malware.

4. Windows XP SP3

	Windows XP adalah jajaran sistem operasi berbasis grafis yang dibuat oleh Microsoft untuk digunakan pada komputer pribadi, yang mencakup komputer rumah dan desktop bisnis, laptop, dan pusat media (Media Center). Nama "XP" adalah kependekan dari "Experience". Windows XP merupakan penerus Windows 2000 Professional dan Windows Me, dan merupakan versi sistem operasi Windows pertama yang berorientasi konsumen yang dibangun di atas kernel dan arsitektur Windows NT. Windows XP pertama kali dirilis pada 25 Oktober 2001, dan lebih dari 400 juta salinan instalasi digunakan pada Januari 2006, menurut perkiraan seorang analis IDC. Windows XP digantikan oleh Windows Vista, yang dirilis untuk pengguna volume license pada 8 November 2006, dan di seluruh dunia untuk masyarakat umum pada tanggal 30 Januari 2007. Banyak Original Equipment Manufacturer (OEM) dan juga penjual ritel menghentikan produksi perangkat dengan Windows XP pada tanggal 30 Juni 2008. Microsoft sendiri terus menjual Windows XP melalui Custom-built PC (OEM kecil yang menjual komputer rakitan) sampai dengan 31 Januari 2009. Windows XP mungkin akan tetap tersedia bagi para pengguna korporasi dengan volume licensing, sebagai sarana downgrade untuk komputer-komputer yang belum siap menjalankan sistem operasi baru, Windows Vista Business Edition atau Ultimate Edition atau Windows 7 Professional.

	Pada analisis malware disini Windows XP SP3 berperan sebagai analyzer machine atau dengan kata lain sebagai mesin tempat di jalankannya malware untuk di analisis. Malware yang akan di analisis pada percobaan kali ini berformat microsoft office word. Maka dari itu di perlukan instalasi microsoft office word. Disarankan untuk menginstall office word 2007 untuk mengatasi masalah kompatibilitas.

5. Cuckoo Sandbox
	Cuckoo Sandbox merupakan salah satu sistem atau perangkat yang digunakan untuk menganalisis sebuah suspect dalam bentuk malware, atau bahasa keren nya Malware Analysis Research Toolkit (MART). Cuckoo Sandbox merupakan perangkat yang gratis atau dalam bahasa lain Open Source. Cara kerja dari Cuckoo Sandbox ini adalah dengan memantau segala kejadian yang mungkin di ditimbulkan oleh sebuah malware yang secara sengaja di run di sebuah environtment yang terisolasi. Maksud environtment di sini adalah Operating System yang biasa kita pakai sehari-hari (paling besar kemungkinan adalah windows). Dan sudah tentu kita membuat nya dalam sebuah Virtual Machine. Dalam pembuatan environtment tersebut, kita harus membuatnya semirip mungkin, agar kinerja Cuckoo ini menjadi maksimal. Sebagai contoh kita install aplikasi yang sehari-hari kita gunakan bila manjalankan sebuah computer ber-OS kan windows seperti Office, Flash Player, Adobe Reader, Firefox, dll. 

6. Malware yang Akan Dianalisis

	Pengertian Malware adalah setiap program atau file yang berbahaya ("malicious software”)  bagi pengguna komputer. Dengan demikian, malware termasuk virus komputer,  worm, Trojan horse , dan juga spyware. Bentuk file sangat beragam di dunia ini. Ada yang berbentuk executeable program(.exe), berbentuk office program(.doc, .pdf), picture(.png, .jpeg) dan lain - lain. Biasanya file malware bisa sampai masuk ke komputer kita itu melalui internet. Seorang attacker bisa menyelipkan kode malware ke file yang kita download atau akses.

	Pada percobaan kali ini malware yang akan dianalisis adalah malware berbentuk file office. Yang akan dianalisis yaitu apa yang dilakukan malware tersebut pada mesin yang terjangkit malware tersebut.

#C. Penjelasan instalasi Cuckoo Sandbox
####Lingkungan Kerja Cuckoo Sandbox
#####Host :
 Ubuntu 16.04 LTS (Virtual Machine)

 4GB RAM

 Virtual Box 5.0.24

 Cuckoo Sandbox 2.0-RC1
#####Guest :
 Windows XP SP3

 Microsoft Office 2007

 1025MB RAM
####Instalasi Cuckoo Sandbox
1. Menginstall paket-paket yang dibutuhkan oleh Cuckoo Sandbox

 `sudo apt-get install git mongodb libffi-dev build-essential python-django python python-dev python-pip python-pil python-sqlalchemy python-bson python-dpkt python-jinja2 python-magic python-pymongo python-gridfs python-libvirt python-bottle python-pefile python-chardet tcpdump -y`

2. Mengkonfigurasi Tcpdump

 Mengkonfigurasi Tcpdump supaya tidak berjalan pada hak root karena Cuckoo tidak berjalan pada hak root

 `sudo setcap cap_net_raw,cap_net_admin=eip /usr/sbin/tcpdump`

 kemudian jalankan perintah dibawah ini :

 `getcap /usr/sbin/tcpdump`

 setelah  dijalankan seharusnya akan keluar hasil seperti dibawah ini :

 `/usr/sbin/tcpdump = cap_net_admin,cap_net_raw+eip`

3. Installing Yara

 `sudo apt-get install autoconf libtool libjansson-dev libmagic-dev libssl-dev -y`

 `wget https://github.com/plusvic/yara/archive/v3.4.0.tar.gz -O yara-3.4.0.tar.gz`

 `tar -zxf yara-3.4.0.tar.gz`

 `cd yara-3.4.0`

 `./bootstrap.sh`

 `./configure --with-crypto --enable-cuckoo --enable-magic`

 `make`

 `sudo make install`

 Setelah melakukan perintah di atas lakukan pengecekan versi yara dengan perintah di bawah ini

 `yara -v`

 maka hasilnya adalah `yara 3.4.0` karena versi yang kita install adalah 3.4.0

4. Installing Pydeep

 Pertama menginstall ssdeep terlebih dahulu

 `wget http://sourceforge.net/projects/ssdeep/files/ssdeep-2.13/ssdeep-2.13.tar.gz/download -O ssdeep-2.13.tar.gz`

 `tar -zxf ssdeep-2.13.tar.gz`

 `cd ssdeep-2.13`

 `./configure`

 `make`

 `sudo make install`

 Kemudian install Pydeep

 `pip install pydeep`

5. Installing Volatility

 Menginstall paket-paket yang dibutuhkan Volatility

 `pip install openpyxl`

 `pip install ujson`

 `pip install pycrypto`

 `pip install distorm3`

 `pip install pytz `

 Untuk menginstall Volatility lakuka perintah di bawah ini

 `git clone https://github.com/volatilityfoundation/volatility.git`

 `cd volatility`

 `python setup.py build`

 `python setup.py install`

6. Installing Cuckoo

 `git clone git://github.com/cuckoosandbox/cuckoo.git`

 Supaya Cuckoo tidak berjalan pada root

 `chown -R ubuntu:ubuntu /home/ubuntu/cuckoo`

7. Installing Virtual Box

  `sudo apt-get install vitualbox`

8. Menyiapkan Virtual Box untuk installasi Windows XP

 [![8.png](https://s5.postimg.org/i6qtsqmh3/image.png)](https://postimg.org/image/nux4jmqtf/)

 [![9.png](https://s5.postimg.org/53v79gw93/image.png)](https://postimg.org/image/cjugv9jyb/)

 Memilih image ISO Windows XP

 [![10.png](https://s5.postimg.org/3q3ke5wzr/image.png)](https://postimg.org/image/5hwj92gcj/)

 Konfigurasi Network supaya menggunakan Host-Only Adapter vboxnet0

 [![11.png](https://s5.postimg.org/h8agqg953/image.png)](https://postimg.org/image/pdsiolxdv/)

9. Mengkonfigurasi vboxnet0 host-only adapter supaya virtual box terisolasi

 `sudo iptables -A FORWARD -o eth0 -i vboxnet0 -s 192.168.56.0/24 -m conntrack --ctstate NEW -j ACCEPT`

 `sudo iptables -A FORWARD -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT`

 `sudo iptables -A POSTROUTING -t nat -j MASQUERADE`

 `sudo sysctl -w net.ipv4.ip_forward=1`

10. Installing Windows XP

 [![6.png](https://s5.postimg.org/7u4j6nsxz/image.png)](https://postimg.org/image/lb1hpj39f/)

11. Konfigurasi Windows XP
 	1. Installing Python 2.7
		https://www.python.org/downloads/release/python-2711/

 	2. Installing PIL(Python Imaging Library)
		http://effbot.org/downloads/PIL-1.1.7.win32-py2.7.exe

 	3. Installing Microsoft Office 2007
 		[![7.png](https://s5.postimg.org/8xonimdl3/image.png)](https://postimg.org/image/hspht52df/)
 
 	4. Konfigurasi IP WindowsXP
		[![konfigurasi IP windows XP.png](https://s13.postimg.org/hrdgkw6ef/konfigurasi_IP_windows_XP.png)](https://postimg.org/image/ao5l5a0yr/)

	Setelah melakukan konfigurasi diatas jalankan agent.pyw kemudian ambil snapshot dengan command berikut :

	-> Jalankan agent.pyw 
	[![jalankan agent.png](https://s18.postimg.org/ncu1nup15/jalankan_agent.png)](https://postimg.org/image/hbwcqs2et/)

	-> Ambil snapshot
		`$ vboxmanage snapshot "windowsxp" take "snapshot1" --pause`
		`$ vboxmanage controlvm "windowsxp" poweroff`
		`$ vboxmanage snapshot "windowsxp" restorecurrent`

12. Konfigurasi Cuckoo
	-> cuckoo.conf
    	machinery = virtualbox
    	[resultserver]
    	ip = 192.168.56.1 #This is the IP address of the host
    	port = 2042 #leave default unless you have services running
    
    -> auxiliary.conf
    	[sniffer]
        # Enable or disable the use of an external sniffer (tcpdump) [yes/no].
        enabled = yes

        # Specify the path to your local installation of tcpdump. Make sure this
        # path is correct.
        # You can check this using the command: whereis tcpdump
        tcpdump = /usr/sbin/tcpdump

        # Specify the network interface name on which tcpdump should monitor the
        # traffic. Make sure the interface is active.
        # The ifconfig command will show you the interface name.
        interface = vboxnet0
        
    -> virtualbox.conf
        machines = windowsxp

        [windowsxp]
        label = windowsxp
        platform = windows
        ip = 192.168.56.10 # IP address of the guest
        snapshot = snapshot1 # name of snapshot
        
     -> reporting.conf
     	[mongodb]
		 enabled = yes
        [reporthtml]
        enabled = yes
        
    Setelah melakukan konfigurasi diatas jalankan cuckoo dengan cara :
    `cd /home/pksj/cuckoo`
    `python cuckoo.py`
    
    Jika cuckoo berjalan sesuai dengan tampilan di bawah ini, maka instalasi cuckoo telah berhasil dan siap digunakan.
    [![cuckoo berhasil dijalankan.png](https://s15.postimg.org/49wu150ez/cuckoo_berhasil_dijalankan.png)](https://postimg.org/image/ln74fzvpz/)
        
        
#D. Analisis malware
Untuk melakukan analisis malware menggunakan cuckoo kita hanya perlu mensubmit file malware menggunakan submit.py yang ada pada direktori /utils. Untuk melakukan pengujuan disarankan untuk meletakkan file malware pada satu folder. Berikut langkah - langkah analisis :
1. Jalankan cuckoo
	`cd /home/pksj/cuckoo`
    `python cuckoo.py`
2. Submit malware	
	`cd /home/pksj/cuckoo/utils`
    `python submit.py <direktori malware>`
    pada kasus ini :
    `python submit.py /home/pksj/Documents/Malware`
3. Tunggu hingga cuckoo selesai menganalisis. Hasil analisis dapat dilihat pada /home/pksj/cuckoo/storage/analyses

###Hasil
#####1. invoice_J-19161427.doc
		Terlampir pada folder laporan ini
#####2. ticket_432247.doc
		Terlampir pada folder laporan ini
#####3. billing_doc_60787.doc
		Terlampir pada folder laporan ini
#E. Kesimpulan dan Saran
